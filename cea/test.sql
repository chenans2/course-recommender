DROP VIEW IF EXISTS part3;

CREATE TEMPORARY VIEW part3 AS
SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='960120' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='960120' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='960120' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='960120' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='960120' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='960120' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='960120' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='960120' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='960120' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='960120' AND skill_id=77) AS s_77  FROM students WHERE username='960120' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='CC' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='CC' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='CC' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='CC' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='CC' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='CC' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='CC' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='CC' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='CC' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='CC' AND skill_id=77) AS s_77  FROM students WHERE username='CC' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Darkmoot' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Darkmoot' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Darkmoot' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Darkmoot' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Darkmoot' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Darkmoot' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Darkmoot' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Darkmoot' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Darkmoot' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Darkmoot' AND skill_id=77) AS s_77  FROM students WHERE username='Darkmoot' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Dong' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Dong' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Dong' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Dong' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='Dong' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Dong' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Dong' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Dong' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Dong' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='Dong' AND skill_id=77) AS s_77  FROM students WHERE username='Dong' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='JiH' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='JiH' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='JiH' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='JiH' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='JiH' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='JiH' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='JiH' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='JiH' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='JiH' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='JiH' AND skill_id=77) AS s_77  FROM students WHERE username='JiH' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='YolandaXiao' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='YolandaXiao' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='YolandaXiao' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='YolandaXiao' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='YolandaXiao' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='YolandaXiao' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='YolandaXiao' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='YolandaXiao' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='YolandaXiao' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='YolandaXiao' AND skill_id=77) AS s_77  FROM students WHERE username='YolandaXiao' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, 2 AS t_82 , 4 AS t_52 , 4 AS t_5 , 4 AS t_22 , 3 AS t_72 , 2 AS s_35 , 1 AS s_7 , 3 AS s_40 , 2 AS s_57 , 1 AS s_77  FROM students WHERE username='auser1' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c3maiyan' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c3maiyan' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c3maiyan' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c3maiyan' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c3maiyan' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c3maiyan' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c3maiyan' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c3maiyan' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c3maiyan' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c3maiyan' AND skill_id=77) AS s_77  FROM students WHERE username='c3maiyan' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c4lz' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c4lz' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c4lz' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c4lz' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='c4lz' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c4lz' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c4lz' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c4lz' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c4lz' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='c4lz' AND skill_id=77) AS s_77  FROM students WHERE username='c4lz' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cai' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cai' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cai' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cai' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cai' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cai' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cai' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cai' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cai' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cai' AND skill_id=77) AS s_77  FROM students WHERE username='cai' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ccccc' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ccccc' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ccccc' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ccccc' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ccccc' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ccccc' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ccccc' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ccccc' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ccccc' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ccccc' AND skill_id=77) AS s_77  FROM students WHERE username='ccccc' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cheerful' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cheerful' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cheerful' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cheerful' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='cheerful' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cheerful' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cheerful' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cheerful' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cheerful' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='cheerful' AND skill_id=77) AS s_77  FROM students WHERE username='cheerful' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='fw' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='fw' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='fw' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='fw' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='fw' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='fw' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='fw' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='fw' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='fw' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='fw' AND skill_id=77) AS s_77  FROM students WHERE username='fw' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ilovechicken' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ilovechicken' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ilovechicken' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ilovechicken' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ilovechicken' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ilovechicken' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ilovechicken' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ilovechicken' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ilovechicken' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ilovechicken' AND skill_id=77) AS s_77  FROM students WHERE username='ilovechicken' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalala' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalala' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalala' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalala' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalala' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalala' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalala' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalala' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalala' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalala' AND skill_id=77) AS s_77  FROM students WHERE username='lalalala' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalalol' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalalol' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalalol' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalalol' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='lalalalol' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalalol' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalalol' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalalol' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalalol' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='lalalalol' AND skill_id=77) AS s_77  FROM students WHERE username='lalalalol' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='madame_id' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='madame_id' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='madame_id' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='madame_id' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='madame_id' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='madame_id' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='madame_id' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='madame_id' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='madame_id' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='madame_id' AND skill_id=77) AS s_77  FROM students WHERE username='madame_id' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='mic' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='mic' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='mic' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='mic' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='mic' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='mic' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='mic' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='mic' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='mic' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='mic' AND skill_id=77) AS s_77  FROM students WHERE username='mic' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ncjc' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ncjc' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ncjc' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ncjc' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ncjc' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ncjc' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ncjc' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ncjc' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ncjc' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ncjc' AND skill_id=77) AS s_77  FROM students WHERE username='ncjc' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nielie' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nielie' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nielie' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nielie' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nielie' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nielie' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nielie' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nielie' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nielie' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nielie' AND skill_id=77) AS s_77  FROM students WHERE username='nielie' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nj' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nj' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nj' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nj' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='nj' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nj' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nj' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nj' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nj' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='nj' AND skill_id=77) AS s_77  FROM students WHERE username='nj' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='oooo' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='oooo' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='oooo' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='oooo' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='oooo' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='oooo' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='oooo' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='oooo' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='oooo' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='oooo' AND skill_id=77) AS s_77  FROM students WHERE username='oooo' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='raz24' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='raz24' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='raz24' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='raz24' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='raz24' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='raz24' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='raz24' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='raz24' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='raz24' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='raz24' AND skill_id=77) AS s_77  FROM students WHERE username='raz24' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ruanhaoy' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ruanhaoy' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ruanhaoy' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ruanhaoy' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ruanhaoy' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ruanhaoy' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ruanhaoy' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ruanhaoy' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ruanhaoy' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ruanhaoy' AND skill_id=77) AS s_77  FROM students WHERE username='ruanhaoy' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='siucourt' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='siucourt' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='siucourt' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='siucourt' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='siucourt' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='siucourt' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='siucourt' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='siucourt' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='siucourt' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='siucourt' AND skill_id=77) AS s_77  FROM students WHERE username='siucourt' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='sos' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='sos' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='sos' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='sos' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='sos' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='sos' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='sos' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='sos' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='sos' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='sos' AND skill_id=77) AS s_77  FROM students WHERE username='sos' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='student335' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='student335' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='student335' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='student335' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='student335' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='student335' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='student335' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='student335' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='student335' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='student335' AND skill_id=77) AS s_77  FROM students WHERE username='student335' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) UNION SELECT DISTINCT username, COALESCE(age, (SELECT AVG(age) FROM (SELECT * FROM students EXCEPT SELECT * FROM students WHERE username='auser1'))) AS age,gender, COALESCE(native_country, 'na') AS native_country, (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ww' AND topic_id=82) AS t_82 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ww' AND topic_id=52) AS t_52 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ww' AND topic_id=5) AS t_5 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ww' AND topic_id=22) AS t_22 , (SELECT DISTINCT interest_before FROM students NATURAL JOIN topic_interests WHERE username='ww' AND topic_id=72) AS t_72 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ww' AND skill_id=35) AS s_35 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ww' AND skill_id=7) AS s_7 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ww' AND skill_id=40) AS s_40 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ww' AND skill_id=57) AS s_57 , (SELECT DISTINCT rank_before FROM students NATURAL JOIN skill_rankings WHERE username='ww' AND skill_id=77) AS s_77  FROM students WHERE username='ww' AND (t_82 IS NOT NULL OR t_52 IS NOT NULL OR t_5 IS NOT NULL OR t_22 IS NOT NULL OR t_72 IS NOT NULL OR s_35 IS NOT NULL OR s_7 IS NOT NULL OR s_40 IS NOT NULL OR s_57 IS NOT NULL OR s_77 IS NOT NULL ) ;
